{"tags":[{"name":"Vim","permalink":"http://blog.keepmovingxin.com/tags/Vim/","url":"/async/tags/Vim.json","count":1}],"categories":[{"name":"工具","permalink":"http://blog.keepmovingxin.com/categories/工具/","url":"/async/categories/工具.json","count":3}],"url":"/async/posts/2016/04/29/vi-vim-delete-M.json","date":1461908371000,"path":{"year":2016,"month":4,"day":29,"name":"vi-vim-delete-M"},"title":"vi/vim显示中文字符并且去掉^M的方法","permalink":"http://blog.keepmovingxin.com/2016/04/29/vi-vim-delete-M/","content":"<ul>\n<li>处理项目xml配置时vim打开经常会碰到中文显示不正常的现象，也就是传说中的乱码，搜索找到一个解决办法，记录一下，但是gbk编码的正常了，utf8的又不对了，于是稍微改了一点。</li>\n</ul>\n<a id=\"more\"></a>\n<h3 id=\"用户目录下创建-vimrc文件\"><a href=\"#用户目录下创建-vimrc文件\" class=\"headerlink\" title=\"用户目录下创建.vimrc文件\"></a>用户目录下创建.vimrc文件</h3><p>加入</p>\n<pre><code>set fileencodings=utf-8,gb2312,gbk,gb18030\nset termencoding=utf-8\nset fileformats=unix\nset encoding=prc\n</code></pre><p>fileencodings中utf-8要在前面</p>\n<p>这样就能正常显示中文了，配合pietty，可以完全正常显示、编辑中文了。</p>\n<h3 id=\"几种去除-M的方法\"><a href=\"#几种去除-M的方法\" class=\"headerlink\" title=\"几种去除^M的方法\"></a>几种去除^M的方法</h3><p>1、<code>cat filename1 | tr -d &quot;\\r&quot; &gt; newfile</code></p>\n<p>2、 <code>sed -e &quot;s/^V^M//&quot; filename &gt; outputfilename</code></p>\n<p>3、vi： 用vi打开文件</p>\n<p>(1) 按ESC键</p>\n<p>(2) 输入 :%s/^M//g</p>\n<p>确定 ^M是使用 “CTRL-V CTRL-M” 而不是字面上的 ^M。</p>\n<p>这个正则式将替换所有回车符前的 ^M为空($是为了保证^M出现在行尾)</p>\n<p>4、用 vim 输入 :<code>set notextmode</code></p>\n<p>可惜，经过上面的处理以后，^M是不存在了，但是换行不成功。所有的东西都在一行上面，看着很费劲。这说明处理的时候文件缺少”\\n”，可以在替换的时候添加上即可：</p>\n<p><code>cat filename | tr &quot;\\r&quot; &quot;\\n&quot; &gt; newfile</code></p>\n<p>注: ^M 可以用Sublime Text编辑器查看</p>\n<p>一些linux版本有 dos2unix 程序，可以用来祛除^M</p>\n"}